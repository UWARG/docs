<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <meta name="author" content="University of Waterloo Aerial Robotics Group">
  <link rel="shortcut icon" href="../../favicon.ico">
  
  <title>Writing Tests - WARG Docs</title>
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700' rel='stylesheet' type='text/css'>

  <link rel="stylesheet" href="../../css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../css/theme_extra.css" type="text/css" />
  <link rel="stylesheet" href="../../css/highlight.css">
  
  <script>
    // Current page data
    var mkdocs_page_name = "Writing Tests";
    var mkdocs_page_input_path = "computer-vision\\Writing-Tests.md";
    var mkdocs_page_url = "/computer-vision/Writing-Tests/";
  </script>
  
  <script src="../../js/jquery-2.1.1.min.js"></script>
  <script src="../../js/modernizr-2.8.3.min.js"></script>
  <script type="text/javascript" src="../../js/highlight.pack.js"></script> 
  
  <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-68186801-2', 'docs.uwarg.com');
      ga('send', 'pageview');
  </script>
  
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
      <div class="wy-side-nav-search">
        <a href="../.." class="icon icon-home"> WARG Docs</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
	<ul class="current">
	  
          
            <li class="toctree-l1">
		
    <a class="" href="../..">Home</a>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Bootcamps</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../bootcamp/mechanical/">Mechanical</a>
                </li>
                <li class="">
                    
    <a class="" href="../../bootcamp/computer-vision/">Computer Vision</a>
                </li>
                <li class="">
                    
    <a class="" href="../../bootcamp/electrical/">Electrical</a>
                </li>
                <li class="">
                    
    <a class="" href="../../bootcamp/groundstation/">Groundstation</a>
                </li>
                <li class="">
                    
    <a class="" href="../../bootcamp/embedded/">Embedded Software</a>
                </li>
                <li class="">
                    
    <a class="" href="../../bootcamp/embedded-archived/">Archived Embedded Software</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Tutorials</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../tutorials/git/">Git and Github</a>
                </li>
                <li class="">
                    
    <a class="" href="../../tutorials/shell/">Using the terminal</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Groundstation</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../groundstation/">Table of Contents</a>
                </li>
                <li class="">
                    
    <a class="" href="../../groundstation/introduction/">Introduction</a>
                </li>
                <li class="">
                    
    <a class="" href="../../groundstation/what-you-need-to-know/">What you need to know</a>
                </li>
                <li class="">
                    
    <a class="" href="../../groundstation/installation/">Installation</a>
                </li>
                <li class="">
                    
    <a class="" href="../../groundstation/tutorial/">Tutorial</a>
                </li>
                <li class="">
                    
    <a class="" href="../../groundstation/project-structure/">Project Structure</a>
                </li>
                <li class="">
                    
    <a class="" href="../../groundstation/contributing/">Contributing</a>
                </li>
                <li class="">
                    
    <a class="" href="../../groundstation/documenting/">Documenting</a>
                </li>
                <li class="">
                    
    <a class="" href="../../groundstation/resources/">Additional Resources</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">ZeroPilot</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../zeropilot/">Table of Contents</a>
                </li>
                <li class="">
                    
    <a class="" href="../../zeropilot/pinout_reference/">Pinout Reference</a>
                </li>
                <li class="">
                    
    <a class="" href="../../zeropilot/hardware/">Hardware</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Network</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../network/data_relay/">Data Relay</a>
                </li>
                <li class="">
                    
    <a class="" href="../../network/multi_echo/">Multi Echo</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Computer Vision</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../">Table of Contents</a>
                </li>
                <li class="">
                    
    <a class="" href="../Installation/">Installation</a>
                </li>
                <li class="">
                    
    <a class="" href="../Building-the-project-%5BLinux%5D/">Building the project [Linux]</a>
                </li>
                <li class="">
                    
    <a class="" href="../Building-the-project-%5BWindows%5D/">Building the project [Windows]</a>
                </li>
                <li class="">
                    
    <a class="" href="../Coding-Conventions/">Coding Conventions</a>
                </li>
                <li class="">
                    
    <a class="" href="../Contributing/">Contributing</a>
                </li>
                <li class="">
                    
    <a class="" href="../Using-the-WARG-server-environment/">Using the WARG computer environment</a>
                </li>
                <li class=" current">
                    
    <a class="current" href="./">Writing Tests</a>
    <ul class="subnav">
            
    <li class="toctree-l3"><a href="#writing-tests">Writing Tests</a></li>
    
        <ul>
        
            <li><a class="toctree-l4" href="#test-heirarchy">Test heirarchy</a></li>
        
            <li><a class="toctree-l4" href="#example">Example</a></li>
        
        </ul>
    

    </ul>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Mechanical</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../mechanical/">Table of Contents</a>
                </li>
                <li class="">
                    
    <a class="" href="../../mechanical/cad-guidelines/">CAD Guidelines</a>
                </li>
                <li class="">
                    
    <a class="" href="../../mechanical/3d-printing-guidelines/">3D Printing Guidelines</a>
                </li>
                <li class="">
                    
    <a class="" href="../../mechanical/grabcad/">GrabCad</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">PicPilot</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../picpilot/">Table of Contents</a>
                </li>
                <li class="">
                    
    <a class="" href="../../picpilot/introduction/">Introduction</a>
                </li>
                <li class="">
                    
    <a class="" href="../../picpilot/pid-loops/">PID Loops</a>
                </li>
                <li class="">
                    
    <a class="" href="../../picpilot/pwm-io/">PWM and IO</a>
                </li>
                <li class="">
                    
    <a class="" href="../../picpilot/uart/">UART</a>
                </li>
                <li class="">
                    
    <a class="" href="../../picpilot/spi/">SPI</a>
                </li>
                <li class="">
                    
    <a class="" href="../../picpilot/direct-memory-access/">Direct Memory Access</a>
                </li>
                <li class="">
                    
    <a class="" href="../../picpilot/i2c/">I2C</a>
                </li>
                <li class="">
                    
    <a class="" href="../../picpilot/datalink/">Datalink</a>
                </li>
                <li class="">
                    
    <a class="" href="../../picpilot/analog-to-digital-converter/">Analog to Digital Converter</a>
                </li>
                <li class="">
                    
    <a class="" href="../../picpilot/sensors-and-peripherals/">Sensors and Peripherals</a>
                </li>
                <li class="">
                    
    <a class="" href="../../picpilot/attitude-control/">Attitude Control</a>
                </li>
                <li class="">
                    
    <a class="" href="../../picpilot/path-management/">Path Management</a>
                </li>
                <li class="">
                    
    <a class="" href="../../picpilot/resources/">Resources</a>
                </li>
                <li class="">
                    
    <a class="" href="../../picpilot/faq/">FAQ</a>
                </li>
    </ul>
	    </li>
          
        </ul>
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../..">WARG Docs</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../..">Docs</a> &raquo;</li>
    
      
        
          <li>Computer Vision &raquo;</li>
        
      
    
    <li>Writing Tests</li>
    <li class="wy-breadcrumbs-aside">
      
        <a href="https://github.com/UWARG/edit/master/docs/computer-vision\Writing-Tests.md"
          class="icon icon-github"> Edit on GitHub</a>
      
    </li>
  </ul>
  <hr/>
</div>
          <div role="main">
            <div class="section">
              
                <h1 id="writing-tests">Writing Tests</h1>
<p>Testing should be done in a directory inside the submodule called test, which should be included in the module's CMakeLists.txt via add_subdirectory and should have its own CMakeLists.txt.
Furthermore, large test files should be stored in the global computer-vision/testdata directory so that they can be shared between multiple tests.
That is, test directories should have the following structure</p>
<pre><code>|-- computer-vision
    |-- modules
        |-- MODULE_NAME
            |-- include
            |-- src
            |-- test
                |-- CMakeLists.txt
                |-- foo_test.cpp
                |-- bar_test.cpp
            |-- CMakeLists.txt
    |-- testdata
        |-- image.jpg
</code></pre>

<p>Testing should be done using the boost test framework.</p>
<p>Tutorials provided by boost are found <a href="http://www.boost.org/doc/libs/1_60_0/libs/test/doc/html/boost_test/practical_usage_recommendations/tutorials.html">here</a>.</p>
<p>API Reference available <a href="http://www.boost.org/doc/libs/1_60_0/libs/test/doc/html/boost_test/utf_reference.html">here</a></p>
<p>To test code it should be run inside the <code>BOOST_AUTO_TEST_CASE</code> and use the boost test macros to verify sanity and results.
Some available macros include</p>
<pre><code class="cpp">BOOST_WARN(predicate); // produces a warning if predicate is false, does not cause failures
BOOST_CHECK(predicate); // produces a failure if predicate is false, but continues testing
BOOST_REQUIRE(predicate); // produces a failure if predicate is false and aborts test suite.
</code></pre>

<h3 id="test-heirarchy">Test heirarchy</h3>
<p>Boost tests are stored in a heirarchy of nested suites.
The global suite for a file can be set with the <code>BOOST_TEST_MODULE</code> macro.
You can define additional suites by encapsulating test cases and suites with <code>BOOST_AUTO_TEST_SUITE(SuiteName);</code> and <code>BOOST_AUTO_TEST_SUITE_END();</code></p>
<p><em>Note that currently the xsl parser for generating an xUnit compatible XML file does not properly handle nested test suites and only makes use of the suite directly encapsulating the test cases (the suite declared with <code>BOOST_TEST_MODULE</code>).
However since this is expected to be fixed relatively soon, it is recommended that you use the following format to declare tests.</em></p>
<h4 id="guidelines-for-naming-test-suites-and-test-cases">Guidelines for naming test suites and test cases</h4>
<p>The global test suite for a file (specified with <code>BOOST_TEST_MODULE</code>) should correspond to the computer-vision module the tests are part of.
A test suite should be created for each file with <code>BOOST_AUTO_TEST_SUITE</code> and should encompass all the tests in the file. Tests contained within a single file should all test a single feature or function of the program. Tests for different features/functions should go in their own file with a separate test suite. The file should also have the same name as the test suite (though test suite names should be camel cased).</p>
<p>Additional test suites can also be created inside test suites at your discretion if a certain suite has a large number of test cases that can be meaningfully subdivided.</p>
<p>For consistency, test suite and test case names should be UpperCamelCase (and test module name should be the full UpperCamelCase version of the module name. e.g. targetid should be TargetIdentification).</p>
<p>Also note that all names should be sufficiently descriptive to be unique in their scope (as well as sufficiently descriptive to convey what is being tested in a particular suite/case). That is, each test suite in a module needs to have a unique name to avoid naming conflicts, but names of test suites inside those suites and names of test cases only need to be unique inside their encapsulating test suite.</p>
<h3 id="example">Example</h3>
<p>file: modules/mymodule/test/mysuite.cpp</p>
<pre><code class="cpp">#define BOOST_TEST_DYN_LINK
#define BOOST_TEST_MODULE MyModule
#include &lt;boost/test/unit_test.hpp&gt;
#include &quot;foo.h&quot; // declares type foo, header is in the core module

BOOST_AUTO_TEST_SUITE(MySuite);

BOOST_AUTO_TEST_CASE(TestName) {
    foo bar;
    BOOST_CHECK(foo.baz());
}

BOOST_AUTO_TEST_SUITE_END();
</code></pre>

<p>file: modules/mymodule/test/CMakeLists.txt</p>
<pre><code class="cmake">include_directories(${Core_INCLUDE_DIR})
add_executable(mytest test.cpp)
target_link_libraries(mytest Core)

# Tests
add_test(
    NAME &quot;example test&quot;
    COMMAND mytest --log_format=XML --log_sink=TEST-mytest.xml --log_level=all --report_level=no
)
</code></pre>
              
            </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../../mechanical/" class="btn btn-neutral float-right" title="Table of Contents">Next <span class="icon icon-circle-arrow-right"></span></a>
      
      
        <a href="../Using-the-WARG-server-environment/" class="btn btn-neutral" title="Using the WARG computer environment"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
      <p>Copyright <a href="http://www.uwarg.com"> University of Waterloo Aerial Robotics Group</a></p>
    
  </div>

  Built with <a href="http://www.mkdocs.org">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
	  
        </div>
      </div>

    </section>
    
  </div>

  <div class="rst-versions" role="note" style="cursor: pointer">
    <span class="rst-current-version" data-toggle="rst-current-version">
      
          <a href="https://github.com/UWARG/" class="fa fa-github" style="float: left; color: #fcfcfc"> GitHub</a>
      
      
        <span><a href="../Using-the-WARG-server-environment/" style="color: #fcfcfc;">&laquo; Previous</a></span>
      
      
        <span style="margin-left: 15px"><a href="../../mechanical/" style="color: #fcfcfc">Next &raquo;</a></span>
      
    </span>
</div>
    <script src="../../js/theme.js"></script>
      <script src="../../sloth-generator.js"></script>

</body>
</html>
